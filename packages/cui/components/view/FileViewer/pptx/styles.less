// PPTX 专用样式，防止被外部样式干扰
// 使用 :global 确保样式被正确应用

:global(.pptx-container) {
	width: 100%;
	height: 100%;
	position: relative;
	background: #f5f5f5;
	display: flex;
	flex-direction: column;
	isolation: isolate; // 创建新的层叠上下文，防止样式干扰
}

:global(.pptx-wrapper) {
	flex: 1;
	width: 100%;
	height: 100%;
	overflow: auto;
	box-sizing: border-box;

	// 使用与系统一致的滚动条样式
	&::-webkit-scrollbar {
		width: 6px;
		height: 6px;
	}

	&::-webkit-scrollbar-thumb {
		background: rgba(0, 0, 0, 0.2);
		border-radius: 3px;

		&:hover {
			background: rgba(0, 0, 0, 0.3);
		}
	}

	&::-webkit-scrollbar-track {
		background: rgba(0, 0, 0, 0.1);
		border-radius: 3px;
	}
}

// PPTX 文档容器样式
:global(.pptx-document) {
	display: flex;
	flex-direction: column;
	gap: 24px;
	padding: 20px;
	align-items: center;
	min-height: 100%;
}

// PPTX 幻灯片样式
:global(.pptx-slide) {
	position: relative;
	width: 800px;
	height: 600px;
	background: white;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
	border-radius: 8px;
	overflow: hidden;
	flex-shrink: 0;
	isolation: isolate; // 防止子元素样式溢出
}

:global(.pptx-slide-content) {
	position: relative;
	width: 100%;
	height: 100%;
	isolation: isolate; // 创建独立的层叠上下文
}

// 文本元素样式
:global(.pptx-text-element) {
	position: absolute;
	display: flex;
	align-items: center;
	justify-content: center;
	padding: 8px;
	box-sizing: border-box;
	word-wrap: break-word;
	overflow-wrap: break-word;
	font-family: Arial, 'Microsoft YaHei', sans-serif;
	line-height: 1.2;
	overflow: hidden;
	text-align: center;

	// 重置可能被继承的样式
	margin: 0;
	border: none;
	outline: none;
	background: transparent;
}

// 文本对齐样式
:global(.pptx-text-element.text-align-center) {
	justify-content: center;
	text-align: center;
}

:global(.pptx-text-element.text-align-left) {
	justify-content: flex-start;
	text-align: left;
}

:global(.pptx-text-element.text-align-right) {
	justify-content: flex-end;
	text-align: right;
}

:global(.pptx-text-element.text-align-justify) {
	justify-content: stretch;
	text-align: justify;
}

// 图片元素样式
:global(.pptx-image-element) {
	position: absolute;
	overflow: hidden;
	border-radius: 4px;

	img {
		display: block;
		width: 100%;
		height: 100%;
		object-fit: contain;
		margin: 0;
		padding: 0;
		border: none;
	}
}

// 背景元素样式
:global(.pptx-background-element) {
	position: absolute;
	z-index: -1;

	img {
		display: block;
		width: 100%;
		height: 100%;
		object-fit: cover;
		margin: 0;
		padding: 0;
		border: none;
	}
}

// 形状元素样式
:global(.pptx-shape-element) {
	position: absolute;
	border: 1px solid rgba(0, 0, 0, 0.1);
	background: rgba(200, 200, 200, 0.1);
	border-radius: 4px;
	box-sizing: border-box;
}

// 通用元素样式
:global(.pptx-element) {
	position: absolute;
	border: 1px dashed rgba(0, 0, 0, 0.2);
	background: rgba(240, 240, 240, 0.3);
	box-sizing: border-box;
}

// 加载状态样式
:global(.pptx-loading) {
	display: flex;
	align-items: center;
	justify-content: center;
	height: 200px;
	font-size: 16px;
	color: rgba(0, 0, 0, 0.6);
}

// 错误状态样式
:global(.pptx-error) {
	display: flex;
	flex-direction: column;
	align-items: center;
	justify-content: center;
	height: 200px;
	color: rgba(0, 0, 0, 0.4);
	text-align: center;

	.anticon {
		font-size: 48px;
		margin-bottom: 16px;
		color: rgba(0, 0, 0, 0.2);
	}
}
