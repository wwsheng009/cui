@import '~@/styles/preset/vars.less';

._local {
	width: 100%;
	height: 100%;
	display: flex;
	flex-direction: column;
	background: transparent;
	border-radius: 0;
	overflow: hidden;
	position: relative;
	box-sizing: border-box;

	// æœ€å¤§åŒ–çŠ¶æ€æ ·å¼
	&.maximized {
		position: fixed;
		top: 0;
		left: 0;
		width: 100vw;
		height: 100vh;
		z-index: 9999;
		background: rgba(0, 0, 0, 0.9);
		border-radius: 0;
	}

	// å¼€å‘é˜¶æ®µçš„è°ƒè¯•æ ·å¼
	&.debug {
		background: var(--color_neo_bg_card);

		.content {
			height: 100%;
			overflow-y: auto;
			padding: 0;

			// è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼
			&::-webkit-scrollbar {
				width: 12px;
			}

			&::-webkit-scrollbar-thumb {
				background: var(--color_border);
				border-radius: 4px;
				border: 2px solid var(--color_neo_bg_card);

				&:hover {
					background: var(--color_text_grey);
				}
			}

			&::-webkit-scrollbar-track {
				background: var(--color_neo_bg_card);
				border-radius: 4px;
			}
		}

		.fileInfo {
			padding: 16px;
			background: var(--color_warning_bg);
			border-bottom: 1px solid var(--color_warning);
			color: var(--color_neo_text_primary);
			font-size: 11px;
			font-family: monospace;
			line-height: 1.6;
			flex-shrink: 0;

			&::before {
				content: 'ğŸš§ FileViewer å¼€å‘ä¸­ / Under Development';
				display: block;
				font-weight: bold;
				margin-bottom: 12px;
				color: var(--color_warning);
				font-size: 12px;
			}

			div {
				margin-bottom: 4px;
				word-break: break-all;
			}
		}

		.separator {
			height: 1px;
			background: var(--color_neo_border_card);
			flex-shrink: 0;
		}

		.documentContent {
			flex: 1;
			padding: 20px;
			min-height: 0;

			h3 {
				margin: 0 0 20px 0;
				color: var(--color_neo_text_primary);
				font-size: 16px;
				font-weight: 600;
				border-bottom: 2px solid var(--color_main);
				padding-bottom: 8px;
			}

			.paragraph {
				margin-bottom: 24px;

				h4 {
					margin: 0 0 8px 0;
					color: var(--color_main);
					font-size: 14px;
					font-weight: 500;
				}

				p {
					margin: 0;
					color: var(--color_neo_text_primary);
					font-size: 14px;
					line-height: 1.6;
					text-align: justify;
					text-indent: 2em;
				}

				hr {
					margin: 16px 0;
					border: none;
					height: 1px;
					background: var(--color_neo_border_field);
				}
			}

			.footer {
				margin-top: 40px;
				padding-top: 20px;
				border-top: 2px solid var(--color_neo_border_card);
			}
		}
	}

	// æ–‡ä»¶é¢„è§ˆå†…å®¹åŒºåŸŸ
	.fileContent {
		width: 100%;
		height: 100%;
		display: flex;
		align-items: center;
		justify-content: center;
		background: var(--color_neo_bg_card);
	}

	// åŠ è½½çŠ¶æ€
	.loading {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 16px;
		color: var(--color_neo_text_secondary);
		font-size: 14px;
	}

	// é”™è¯¯çŠ¶æ€
	.error {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 16px;
		color: var(--color_danger);
		font-size: 14px;
		text-align: center;
		padding: 20px;

		i {
			font-size: 32px;
			margin-bottom: 8px;
		}
	}

	// ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹
	.unsupported {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 16px;
		color: var(--color_neo_text_secondary);
		font-size: 14px;
		text-align: center;
		padding: 20px;

		i {
			font-size: 32px;
			margin-bottom: 8px;
			color: var(--color_neo_icon_muted);
		}
	}

	// ç»Ÿä¸€çš„å†…å®¹åŒºåŸŸ - åœ¨è¿™å±‚å¤„ç†æ»šåŠ¨æ¡
	.content {
		flex: 1;
		min-height: 0;
		overflow: auto;
		box-sizing: border-box;

		// ä½¿ç”¨ä¸ç³»ç»Ÿä¸€è‡´çš„æ»šåŠ¨æ¡æ ·å¼
		&::-webkit-scrollbar {
			width: 6px;
			height: 6px;
		}

		&::-webkit-scrollbar-thumb {
			background: var(--color_border);
			border-radius: 3px;

			&:hover {
				background: var(--color_text_grey);
			}
		}

		&::-webkit-scrollbar-track {
			background: var(--color_border_soft);
			border-radius: 3px;
		}
	}

	// å·¥å…·æ æ ·å¼ - ç›¸å¯¹äº FileViewer å¤–å±‚å®¹å™¨å®šä½
	.toolbar {
		position: absolute;
		bottom: 12px;
		left: 50%;
		transform: translateX(-50%);
		z-index: 1000;
		display: flex;
		align-items: center;
		gap: 6px;
		background: rgba(255, 255, 255, 0.95);
		backdrop-filter: blur(8px);
		border: 1px solid rgba(255, 255, 255, 0.2);
		border-radius: 8px;
		padding: 6px 10px;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
		opacity: 0.8;
		transition: opacity 0.2s ease;
		pointer-events: auto;

		&:hover {
			opacity: 1;
		}

		.languageTag {
			color: var(--color_text);
			font-size: 11px;
			padding: 2px 6px;
			border-radius: 4px;
			background: var(--color_bg_hover);
			margin-right: 2px;
			font-weight: 500;
		}

		:global(.ant-btn) {
			color: var(--color_text_light);
			border: none;
			background: transparent;
			width: 24px;
			height: 24px;
			border-radius: 4px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 14px;
			transition: all 0.2s ease;

			&:hover {
				background: var(--color_bg_hover);
				color: var(--color_main);
				transform: scale(1.1);
			}

			&:focus {
				background: var(--color_bg_hover);
				color: var(--color_main);
			}

			&:active {
				transform: scale(0.95);
			}
		}
	}

	// æš—è‰²ä¸»é¢˜ä¸‹çš„å·¥å…·æ æ ·å¼
	[data-theme='dark'] & {
		.toolbar {
			background: rgba(47, 47, 52, 0.9);
			border: 1px solid rgba(255, 255, 255, 0.1);

			.languageTag {
				background: var(--color_bg_hover);
				color: var(--color_text);
			}
		}
	}

	// PDF å®¹å™¨æ ·å¼
	.pdfContainer {
		width: 100%;
		height: 100%;
		position: relative;
		display: flex;
		flex-direction: column;
		background: var(--color_bg_menu);
	}

	.pdfViewer {
		flex: 1;
		width: 100%;
		height: 100%;
		min-height: 0;
		background: #f5f5f5;

		iframe {
			display: block;
		}
	}

	.pdfFallback {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		height: 100%;
		padding: 40px 20px;
		text-align: center;
		background: var(--color_bg_menu);
	}

	.pdfIcon {
		font-size: 48px;
		color: var(--color_text_secondary);
		margin-bottom: 16px;
	}

	.pdfInfo {
		max-width: 300px;
	}

	.pdfTitle {
		font-size: 16px;
		font-weight: 500;
		color: var(--color_text_primary);
		margin-bottom: 8px;
		word-break: break-word;
	}

	.pdfMessage {
		font-size: 14px;
		color: var(--color_text_secondary);
		line-height: 1.5;
		margin-bottom: 16px;
	}

	// æš—è‰²ä¸»é¢˜ä¸‹çš„PDFæ ·å¼
	[data-theme='dark'] & {
		.pdfViewer {
			background: #2f2f34;
		}

		.pdfFallback {
			background: var(--color_bg_menu);
		}
	}

	// éŸ³é¢‘å®¹å™¨æ ·å¼
	.audioContainer {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 20px;
		padding: 40px 20px;
		width: 100%;
		max-width: 400px;

		.audioIcon {
			font-size: 48px;
			color: var(--color_text_grey);
		}

		audio {
			width: 100%;
		}
	}

	// æ–‡æœ¬å†…å®¹æ ·å¼
	.loading {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 100%;
		height: 100%;
		color: var(--color_text_grey);
	}

	.codeBlock {
		margin: 0;
		padding: 16px;
		background: var(--color_bg_menu); // ä¸å›¾ç‰‡viewerèƒŒæ™¯ä¸€è‡´
		border: none;
		font-size: 13px;
		line-height: 1.5;
		color: var(--color_text);
		white-space: pre-wrap;
		word-wrap: break-word;
		overflow-wrap: break-word;
		width: 100%;
		min-height: 100%;
		box-sizing: border-box;
		font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
		display: block;

		code {
			background: transparent;
			padding: 0;
			font-family: inherit;
			font-size: inherit;
			word-wrap: break-word;
			display: block;
		}

		// è¯­æ³•é«˜äº®æ ·å¼
		:global(.syntax-comment) {
			color: #6a737d;
			font-style: italic;
		}

		:global(.syntax-string) {
			color: #032f62;
		}

		:global(.syntax-keyword) {
			color: #d73a49;
			font-weight: 600;
		}

		:global(.syntax-boolean) {
			color: #005cc5;
		}

		:global(.syntax-number) {
			color: #005cc5;
		}

		:global(.syntax-property) {
			color: #6f42c1;
		}

		:global(.syntax-color) {
			color: #e36209;
		}

		:global(.syntax-tag) {
			color: #22863a;
		}

		:global(.syntax-attribute) {
			color: #6f42c1;
		}

		:global(.syntax-heading) {
			color: #24292e;
			font-weight: 600;
		}

		:global(.syntax-bold) {
			font-weight: 600;
		}

		:global(.syntax-italic) {
			font-style: italic;
		}

		:global(.syntax-code) {
			background: rgba(175, 184, 193, 0.2);
			padding: 2px 4px;
			border-radius: 3px;
			font-family: inherit;
		}

		:global(.syntax-code-block) {
			background: rgba(175, 184, 193, 0.2);
			padding: 8px;
			border-radius: 6px;
			display: block;
			margin: 8px 0;
		}

		:global(.syntax-list-marker) {
			color: #d73a49;
			font-weight: 600;
		}
	}

	// æš—è‰²ä¸»é¢˜ä¸‹çš„è¯­æ³•é«˜äº®
	[data-theme='dark'] & {
		.codeBlock {
			:global(.syntax-comment) {
				color: #8b949e;
			}

			:global(.syntax-string) {
				color: #a5d6ff;
			}

			:global(.syntax-keyword) {
				color: #ff7b72;
			}

			:global(.syntax-boolean) {
				color: #79c0ff;
			}

			:global(.syntax-number) {
				color: #79c0ff;
			}

			:global(.syntax-property) {
				color: #d2a8ff;
			}

			:global(.syntax-color) {
				color: #ffa657;
			}

			:global(.syntax-tag) {
				color: #7ee787;
			}

			:global(.syntax-attribute) {
				color: #d2a8ff;
			}

			:global(.syntax-heading) {
				color: #f0f6fc;
			}

			:global(.syntax-code) {
				background: rgba(110, 118, 129, 0.4);
			}

			:global(.syntax-code-block) {
				background: rgba(110, 118, 129, 0.4);
			}

			:global(.syntax-list-marker) {
				color: #ff7b72;
			}
		}
	}

	// Unsupported viewer styles
	.unsupportedContainer {
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		padding: 40px 20px;
		text-align: center;
		gap: 20px;

		.fileIcon {
			font-size: 64px;
			color: var(--color_text_grey);
		}

		.fileInfo {
			.fileName {
				font-size: 16px;
				font-weight: 500;
				color: var(--color_text);
				margin-bottom: 4px;
			}

			.fileSize {
				font-size: 14px;
				color: var(--color_text_grey);
				margin-bottom: 8px;
			}

			.unsupportedText {
				font-size: 14px;
				color: var(--color_text_light);
			}
		}

		.actions {
			margin-top: 16px;
		}
	}
}
